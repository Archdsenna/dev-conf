# Note: 
#       (1) tmux前缀键已映射为 *空格*
#       (2) 在tmux里使用vim编辑文件时不要使用水平/垂直分屏, 因为vim的窗口移动与
#           tmux的面板移动前缀键都是空格,所以tmux内使用vim的水平/垂直分割窗口功
#           时会引起冲突。tmux主要目的是为了多窗口操作命令,如果编辑多个文件可以
#           新开一个终端,使用vim进行编辑
#       (3) 如果tmux kill-server

# Tmux usage
# =============================================================================



# tmux配置
# =============================================================================
# -------------------------------------                    tmux前缀设置
# 重新设置前缀键为 空格, -g表示全局global
set -g prefix Space
# 取消绑定之前的前缀键C-b
unbind C-b

# -------------------------------------                    设置窗口和面板索引
# 第一个窗口和面板的索引为1
set -g base-index 1
setw -g pane-base-index 1

# 配置颜色,让tmux以256色模式显示内容 
set -g default-terminal "screen-256color"      

# 隐藏底部状态栏 
set -g status off

# 设置前缀键等待延时为 200 毫秒
set -s escape-time 200

# -------------------------------------                    面板分割
# 面板边框指示，设置颜色+箭头
set -g pane-border-indicators "both"        
# 加粗分割线
set -g pane-border-lines "heavy"            
# 非活动窗口面板边框设置为浅白色
set -g pane-border-style "fg=white"         
# 关闭面板状态栏
set -g pane-border-status "off"             

# -------------------------------------                    tmux键盘模式映射为vim
# 将 tmux 的默认键盘模式设置为 vi 模式,设置之后就可以
# 在滚屏时使用h/j/k/l来控制方向进行移动和复制
setw -g mode-keys vi

# -------------------------------------                    启动焦点检测
# Note: set -g focus-events 是 tmux 的一个选项，用于控制
#       是否启用焦点事件。当启用焦点事件时，tmux 会在焦
#       点切换时发送相应的事件通知。具体来说，当焦点从一
#       个窗格切换到另一个窗格时，焦点事件可以让 tmux 发
#       送相应的通知，以便终端可以根据焦点状态进行相应的
#       调整或处理
set -g focus-events

# -------------------------------------                    复制模式下选中内容的背景色
set -g mode-style bg=#afd7af


# tmux快捷键配置
# =============================================================================
# -------------------------------------                    更新配置文件
# Usage:
#       @前缀键+r : tmux内更新配置文件
# Tips:
#       tmux外(未运行tmux时)更新配置文件,在终端执行如下命令:
#           $ tmux source-file ~/.tmux.conf 
bind r source-file ~/.tmux.conf \; display "Reloaded OK!"

# -------------------------------------                    空格输入
# Usage:
#       @空格x2 : 输入空格(将空格作为普通字符进行输入)
bind Space send-prefix

# -------------------------------------                    面板最大/恢复
# Usage:
#        @前缀键+m : 最大化面板,再按一次恢复
# Tips: 助记, m=max, 即最大化面板
bind-key m run-shell "tmux set-window-option -g aggressive-resize on; tmux resize-pane -Z"

# -------------------------------------                    分割面板
# Usage:
#       @前缀键+\ : 垂直分割面板
#       @前缀键+- : 水平分割面板
bind \\ split-window -h
bind - split-window -v

# -------------------------------------                    面板移动
# Usage:
#       @前缀键+h/j/k/l : 移动到左/上/右/下面板
bind h select-pane -L # 左
bind j select-pane -U # 上
bind k select-pane -D # 下
bind l select-pane -R # 右

# -------------------------------------                    调整窗口大小
# Usage:
#       @前缀键+H/J/K/L : 向左/上/下/右扩大面板
bind -r H resize-pane -L 5 # 左
bind -r J resize-pane -U 5 # 上
bind -r K resize-pane -D 5 # 下
bind -r L resize-pane -R 5 # 右

# -------------------------------------                    进入复制模式(可滚屏)
# Note: 前缀+s进入复制模式,h/j/k/l移动光标到目标位置,按v
#       开始复制,此时可以继续h/j/k/l移动选择要复制的内容,
#       最后按y复制选中的内容到系统剪贴版
# Tips: 复制模式下支持像vim一样进行移动选择,例如vfb,选择到字符b
# Usage:
#       @前缀键+s : 进入复制模式
#       @h/j/k/l  : 移动光标左/上/下/右
#       @H/J/K/L  : 大幅度左/上/下/右移动
#       @w/b      : 跳到下/上一个单词
#       @gg/G     : 跳转到顶部/底部
#       @v        : 按v开始复制(开始选中内容)
#       @y        : 按y将选中的内容复制到系统剪贴板
#       @Enter    : 按Enter退出复制模式(返回tmux)
#
# 设置快捷键进入复制模式,可按h/j/k/l移动光标
bind-key s copy-mode    # 助记: s=scroll, 进入滚动(复制模式可滚动)
                        # Tips: 当左右tmux分屏都进入复制模式时,
                        #       前缀键+h/j/k/l切换分屏同样生效,
                        #       并且会保持分屏的模式状态(如果是复制
                        #       模式切换分屏后继续保持复制模式)

bind-key -T copy-mode-vi j send-keys -X cursor-up
bind-key -T copy-mode-vi k send-keys -X cursor-down
bind-key -T copy-mode-vi J run-shell "tmux set repeat-time 0; for i in {1..15}; do tmux send-keys -X cursor-up; done"
bind-key -T copy-mode-vi K run-shell "tmux set repeat-time 0; for i in {1..15}; do tmux send-keys -X cursor-down; done"
bind-key -T copy-mode-vi H run-shell "tmux set repeat-time 0; for i in {1..8}; do tmux send-keys -X cursor-left; done"
bind-key -T copy-mode-vi L run-shell "tmux set repeat-time 0; for i in {1..8}; do tmux send-keys -X cursor-right; done"

# 将选中内容复制到系统剪贴板映射为按 y
bind-key -T copy-mode-vi y send-keys -X copy-pipe "tmux save-buffer - | pbcopy"

# 在 copy-mode-vi 模式下按 v 键开始复制
bind-key -T copy-mode-vi v send-keys -X begin-selection

# -------------------------------------                    进入/退出同时操作所有面板模式
# Usage:
#       @前缀键+a : 按第1次进入同时操作所有面板模式,再按退出
# 使用前缀键+s 开启/关闭同时操作所有面板的模式
bind-key a setw synchronize-panes   # 助记: a=all, 即所有面板

# -------------------------------------                    显示面板编号
# Usage:
#       @前缀键+n : 显示面板编号,直到输入数字编号才消失
# Tips: 助记,n=number, 即数字编号
# 设置前缀键 + n 来显示面板编号，持续显示直到输入
bind n display-panes -d 999999999




